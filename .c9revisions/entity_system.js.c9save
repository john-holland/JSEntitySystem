{"ts":1344349992471,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"\r\nvar NextFreeId = 0;\r\n\r\n/*\r\nThe component metadata collection.\r\nkeyed on the componentName, toLowered\r\nComponent[\"name\"] =    {\r\n    ComponentName : \"name\",\r\n\tMethods : {\r\n\t\tAssigned : method,\r\n\t\tRemoved : method,\r\n\t\tUpdate : method,\r\n\t\tRender : method\r\n\t},\r\n\tRequiredComponents : array of strings,\r\n\tRequiredData : array of data names\r\n}\r\n*/\r\nvar Components = {\r\n};\r\n\r\n/*\r\n  Datas is a \r\n*/\r\nvar Datas = {\r\n};\r\n\r\nvar Entities = {\r\n};\r\n\r\nfunction Component(assigned, removed, update, render) {\r\n\tthis.Assigned = assigned;\r\n\tthis.Removed = removed;\r\n\tthis.Update = update;\r\n\tthis.Render = render;\r\n}\r\n\r\nfunction RegisterComponent(componentName, component, requiredComponents, requiredData) {\r\n\tComponents[componentName] = {\r\n\t\tComponentName : componentName,\r\n\t\tMethods : component,\r\n\t\tRequiredComponents : requiredComponents,\r\n\t\tRequiredData : requiredData\r\n\t};\r\n}\r\n\r\nfunction AddComponent(entity, componentName) {\r\n\tvar component = Components[componentName];\r\n\tvar requiredData = component.RequiredData;\r\n\tvar requiredComponents = component.RequiredComponent;\r\n\t\r\n\tif (!(componentName in entity.Components)) {\r\n\t\tentity.Components[componentName] = Components[componentName];\r\n\t\tentity.UpdateComponents.push(Components[componentName]);\r\n\t}\r\n\t\r\n\tfor (var key in component.RequiredComponents) {\r\n\t\tif (!(key in entity.Components)) {\r\n\t\t\tAddComponent(entity, key);\r\n\t\t}\r\n\t}\r\n\t\r\n\tfor (var key in component.RequiredData) {\r\n\t\tif (!(key in entity.Datas)) {\r\n\t\t\tentity.Datas[key] = component.RequiredData[key];\r\n\t\t}\r\n\t}\r\n}\r\n\r\nRegisterComponent('TestComponent',\r\n\tComponent(\r\n            function(entity, gameTime) {\r\n                //assigned\r\n\t\t\t\t},\r\n\t\t\tfunction(entity, gameTime) {\r\n                //removed\r\n\t\t\t\t},\r\n\t\t\tfunction(entity, gameTime) {\r\n                //update\r\n\t\t\t\t},\r\n\t\t\tfunction(entity, gameTime) {\r\n                //render\r\n\t\t\t}),\r\n\t\t\tnew Array(),\r\n            new Array());\r\n\r\nfunction Entity() {\r\n\tvar self = this;\r\n\tNextFreeId = NextFreeId + 1;\r\n\tthis.Id = NextFreeId;\r\n\tthis.Datas = {\r\n\t};\r\n\tthis.Components = {\r\n\t};\r\n    \r\n\tthis.UpdateComponents = new Array();\r\n\t\r\n    this.AddComponent = function(componentName) {\r\n\t\tif (!(componentName in this.components)) {\r\n\t\t\t//recursively add components here.\r\n\t\t\t//make sure to add each components required data here as well.\r\n\t\t\tAddComponent(componentName);\r\n\t\t}\r\n\t};\r\n    \r\n    this.RemoveComponent = function(componentName) {\r\n        if (componentName in this.components) {\r\n            \r\n        }\r\n    };\r\n\t\r\n\tthis.Update = function(gameTime) {\r\n\t\tvar i = 0;\r\n\t\tfor (i = 0; i < this.UpdateComponents.length; i++) {\r\n\t\t\tthis.UpdateComponents[i].Update(gameTime, self);\r\n\t\t}\r\n\t};\r\n\t\r\n\tEntities[this.Id] = this;\r\n}\r\n\r\nvar ent = new Entity();\r\nalert(ent.test);\r\nalert(Entities[ent.Id].test);"]],"start1":0,"start2":0,"length1":0,"length2":2755}]],"length":2755}
{"contributors":[],"silentsave":true,"ts":1344377344766,"patch":[[{"diffs":[[0,"ay());\r\n"],[1,"d"],[0,"\r\nfuncti"]],"start1":1884,"start2":1884,"length1":16,"length2":17}]],"length":2756,"saved":false}
{"ts":1344377345993,"patch":[[{"diffs":[[0,"ay());\r\n"],[-1,"d"],[0,"\r\nfuncti"]],"start1":1884,"start2":1884,"length1":17,"length2":16}]],"length":2755,"saved":false}
{"ts":1344377352035,"patch":[[{"diffs":[[0,"ent',\r\n\t"],[1,"new "],[0,"Componen"]],"start1":1548,"start2":1548,"length1":16,"length2":20}]],"length":2759,"saved":false}
{"ts":1344377495413,"patch":[[{"diffs":[[0,"mponent("],[-1,"\r\n "],[0,"        "]],"start1":1562,"start2":1562,"length1":19,"length2":16}]],"length":2756,"saved":false}
{"ts":1344377496745,"patch":[[{"diffs":[[0,"mponent("],[-1,"           "],[0,"function"]],"start1":1562,"start2":1562,"length1":27,"length2":16}]],"length":2745,"saved":false}
{"ts":1344377501227,"patch":[[{"diffs":[[0,"        "],[1,"    "],[0,"//assign"]],"start1":1608,"start2":1608,"length1":16,"length2":20},{"diffs":[[0,"//assigned\r\n"],[1,"    "],[0,"\t\t\t\t},\r\n"],[1,"    "],[0,"\t\t\tfunction("]],"start1":1620,"start2":1620,"length1":32,"length2":40},{"diffs":[[0,"            "],[1,"    "],[0,"//removed\r\n\t"]],"start1":1685,"start2":1685,"length1":24,"length2":28},{"diffs":[[0,"emoved\r\n"],[1,"    "],[0,"\t\t\t\t},\r\n"],[1,"    "],[0,"\t\t\tfunct"]],"start1":1704,"start2":1704,"length1":24,"length2":32},{"diffs":[[0,"        "],[1,"    "],[0,"//update"]],"start1":1769,"start2":1769,"length1":16,"length2":20},{"diffs":[[0,"update\r\n"],[1,"    "],[0,"\t\t\t\t},\r\n"],[1,"    "],[0,"\t\t\tfunct"]],"start1":1783,"start2":1783,"length1":24,"length2":32},{"diffs":[[0,"            "],[1,"    "],[0,"//render\r\n\t\t"]],"start1":1844,"start2":1844,"length1":24,"length2":28},{"diffs":[[0,"render\r\n"],[1,"    "],[0,"\t\t\t}),\r\n"]],"start1":1862,"start2":1862,"length1":16,"length2":20}]],"length":2789,"saved":false}
{"ts":1344377502088,"patch":[[{"diffs":[[0,"        "],[1,"    "],[0,"//assign"]],"start1":1612,"start2":1612,"length1":16,"length2":20},{"diffs":[[0,"//assigned\r\n    "],[1,"  "],[1,"  "],[0,"\t\t\t\t},\r\n    \t\t\tf"]],"start1":1624,"start2":1624,"length1":32,"length2":36},{"diffs":[[0,"    \t\t\t\t},\r\n    "],[1,"   "],[1," "],[0,"\t\t\tfunction(enti"]],"start1":1640,"start2":1640,"length1":32,"length2":36},{"diffs":[[0,"            "],[1,"    "],[0,"//removed\r\n "]],"start1":1701,"start2":1701,"length1":24,"length2":28},{"diffs":[[0,"emoved\r\n    "],[1," "],[1,"   "],[0,"\t\t\t\t},\r\n    "]],"start1":1720,"start2":1720,"length1":24,"length2":28},{"diffs":[[0,"    \t\t\t\t},\r\n    "],[1,"  "],[1,"  "],[0,"\t\t\tfunction(enti"]],"start1":1732,"start2":1732,"length1":32,"length2":36},{"diffs":[[0,"        "],[1,"    "],[0,"//update"]],"start1":1797,"start2":1797,"length1":16,"length2":20},{"diffs":[[0,"update\r\n    "],[1," "],[1,"   "],[0,"\t\t\t\t},\r\n    "]],"start1":1811,"start2":1811,"length1":24,"length2":28},{"diffs":[[0,"\t\t\t\t},\r\n    "],[1," "],[1,"   "],[0,"\t\t\tfunction("]],"start1":1827,"start2":1827,"length1":24,"length2":28},{"diffs":[[0,"            "],[1,"    "],[0,"//render\r\n  "]],"start1":1884,"start2":1884,"length1":24,"length2":28},{"diffs":[[0,"render\r\n"],[1,"    "],[0,"    \t\t\t}"]],"start1":1902,"start2":1902,"length1":16,"length2":20}]],"length":2833,"saved":false}
{"ts":1344377520505,"patch":[[{"diffs":[[0,"}),\r\n\t\t\t"],[-1,"new Array()"],[1,"p["],[0,",\r\n     "]],"start1":1921,"start2":1921,"length1":27,"length2":18}]],"length":2824,"saved":false}
{"ts":1344377521683,"patch":[[{"diffs":[[0,"\n\t\t\t"],[-1,"p"],[0,"["],[1,"]"],[0,",\r\n "]],"start1":1925,"start2":1925,"length1":10,"length2":10}]],"length":2824,"saved":false}
{"ts":1344377526379,"patch":[[{"diffs":[[0,"        "],[-1,"new Array()"],[1,"[]"],[0,");\r\n\r\nfu"]],"start1":1938,"start2":1938,"length1":27,"length2":18}]],"length":2815,"saved":false}
{"ts":1344377548156,"patch":[[{"diffs":[[0,"),\r\n"],[-1,"\t\t"],[0,"\t[],\r\n"],[-1,"        "],[0,"    "]],"start1":1922,"start2":1922,"length1":24,"length2":14}]],"length":2805,"saved":false}
